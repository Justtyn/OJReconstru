# 项目迭代路线图

> 管理端已基本成型，以下按阶段细化至上线目标；每个阶段完成后同步更新 dev-log 与实际进度。

## 留痕记录
- 2025-12-17：修复雪花 ID 精度丢失导致的请求参数错误：移除 `Number(classId)` 等转换，作业查询等 ID 参数统一使用字符串；相关 DTO 与 service 方法签名收敛为 string，避免再被当作 number 传递。
- 2025-12-17：管理端二级页面统一增加返回按钮：在 `PageContainer` 中按路由深度自动显示（/admin 下且路径段>2），默认返回到对应模块列表页。
- 2025-12-17：质量与排行页布局调整：近期提交与提交活跃学生同一行展示，高错误率题目独占一行。
- 2025-12-17：仪表盘优化：质量与排行页“高错误率题目”与“近期提交”调整展示顺序；健康度监控增加“接口健康率（本次）”指标。
- 2025-12-17：健康度监控页扩展为“全部前端已接入接口”握手检测：覆盖公告/鉴权/学生/教师/班级/作业/题目/提交/讨论/题解/登录日志/统计等 GET 接口。
- 2025-12-17：健康度监控页接入真实握手检测：定时/手动请求公共与鉴权接口，仅判断是否收到 HTTP 响应并统计 P95 延迟与失败率。
- 2025-12-17：补充 `doc/API_DOC.md` 的接口连通性（握手）检测说明，提供公共接口与鉴权接口的 curl 检测示例。
- 2025-12-17：仪表盘 Tab 调整：移除“运营与个性化”内容并更名为“健康度监控”，以告警卡+指标占位展示“埋点接口响应时间与失败率，显示前端简易健康度”。
- 2025-12-17：内容动态页“最新题解”列表改为仅展示 3 条。
- 2025-12-17：内容动态页移除公告/讨论/题解的跳转与操作按钮；增加条目上下间距并关闭列表分割线，提升列表可读性。
- 2025-12-17：仪表盘优化：质量与排行页首次进入默认时间范围为“全部”；内容动态页公告/讨论/题解列表增加置顶/停用标签、题目/作者/时间信息与内容预览，并预加载题目/作者名称缓存。
- 2025-12-17：优化仪表盘“数据可视化”四个饼图（提交状态/题目/题解/讨论）：隐藏扇区标签避免重叠，图例改为可滚动并截断长文本，tooltip 约束在容器内。
- 2025-12-17：管理端仪表盘调整：将概览页“近期提交”迁移至“质量与排行”页，并把概览页“快捷入口”移动到原“近期提交”区域。
- 2025-12-15：新增客户端“关于系统”页面（/about），用折叠面板汇总评测状态说明、使用指南、功能介绍、联系方式与学习资源推荐，并适配深浅色主题。
- 2025-12-13：登录遇到“邮箱未验证”时自动跳转邮箱验证页并带上用户名，方便直接完成激活。
- 2025-12-13：邮箱验证页新增重新发送验证码按钮且禁用用户名输入，调用 `/api/auth/register/resendCode` 重发并避免误改。
- 2025-12-13：仪表盘欢迎提示移入概览页，数据可视化锁定日粒度并移除切换控件。
- 2025-12-13：可视化接口模型同步 bucket/percentage 变更，管理端仪表盘数据可视化改用 ECharts 折线/饼图并适配深浅色主题。
- 2025-12-12：仪表盘可视化页接入新的 analytics 聚合接口，增加提交/登录/内容趋势折线图与启用状态饼图，并支持日/周/月/全部粒度切换。
- 2025-12-12：学生创建/编辑页学校字段接入本地 schools.json 枚举下拉，支持搜索筛选。
- 2025-12-12：提交流程代码编辑器支持横向滚动避免长行换行；讨论管理新增讨论入口；题目每日挑战改为开关（0/1）；学校下拉过滤掉“本科/专科”后缀仅保留校名；讨论/题解创建改为传 authorId 以适配后端外键校验。
- 2025-12-12：新增提交代码框限制固定高度滚动；提交详情代码区自适应高度且禁用拉伸；题解内容改用代码编辑器。
- 2025-12-12：题目列表新增题目ID列；作业列表根据起止时间显示未开始/进行中/已结束标签。
- 2025-12-12：题目编辑/创建强制校验描述、输入输出、样例、时间/内存限制等字段必填。
- 2025-12-12：移除用例新增/编辑的“是否样例”开关，仅保留输入输出。
- 2025-12-12：仪表盘区分管理员/教师视图，教师优先展示班级作业与提交榜，快捷入口和统计卡按角色裁剪。
- 2025-12-12：仪表盘“数据可视化”接入 analytics 接口，展示核心汇总与提交/题目/登录状态分布。
- 2025-12-12：修复构建类型错误（登录页输入引用、班级/作业/登录日志/题目来源/学生上传、提交语言筛选等）并通过全量构建。
- 2025-12-12：公告管理新增 Markdown 预览抽屉与分段切换置顶筛选；题目列表展示来源与用例数并改为来源枚举下拉；班级编辑支持调整创建教师。
- 2025-12-11：修复管理端菜单选中逻辑，题解/讨论/提交记录正确高亮；更新 AGENTS.md 补充中文对话与留痕要求。
- 2025-12-11：提交记录页新增“新增提交”弹窗与代码编辑器，支持行号/高亮、单选班级与学生并调用提交接口。
- 2025-12-11：提交新增支持按题目或班级-作业两条通路；代码编辑器左距收紧并支持只读；详情页复用编辑器并增加复制按钮。
- 2025-12-11：修复代码编辑器重影问题（文本隐藏由高亮层渲染），滚动条适配深色；提交记录/详情页同步效果。
- 2025-12-11：移除代码编辑器首行空白/重影偏移，改为紧凑模板并与换行对齐。
- 2025-12-11：提交记录查询参数对齐接口（studentId/statusId），新增提交按钮合并至查询区。
- 2025-12-11：管理端仪表盘上线统计卡片、近期提交列表与快捷入口，接入多模块数据并适配深浅色。
- 2025-12-11：仪表盘移除“待办与提示”模块，保持简洁。
- 2025-12-11：仪表盘增加顶部标签页（概览/质量排行/内容动态/运营提示），支持时间范围筛选、错误率榜、学生活跃榜、最新公告讨论题解。

## 近期（本周内）
- [ ] 完善用户/班级/题库管理页：对齐字段校验、分页筛选、空态/加载态、深浅色适配。
- [X] 教师职称枚举：前端下拉改为固定枚举（助教/讲师/副教授/教授等），与后端字段保持一致。
- [X] 学生管理详情扩展：增加学校/年级/联系方式/注册时间/最近登录等信息展示。
- [ ] 班级信息增强：列表显示创建者；详情二级展示当前学生列表，支持多选下拉添加/移除学生。
- [ ] 作业题目多选：作业创建/编辑时可检索所有题目并多选；编辑时预加载已包含题目，避免重复选择。

## 下阶段（下周内）
- [ ] 业务统计图表：对接接口绘制登录/活跃/提交/通过率等图表，支持时间范围切换，兼容深浅色。
- [ ] 邮件 HTML 样式优化：统一品牌色、排版、按钮与响应式；支持暗色预览。
- [ ] 验证码体系：新增本地数字+字母混合验证码或邮件验证码组件；补充“重发验证码”按钮及冷却计时。
- [ ] 管理端导航：教师角色动态展示可见的管理菜单（隐藏管理员专属项），路由守卫保持一致。

## 中期（2-4 周）
- [ ] 客户端启动：搭建客户端首页、题库/讨论/公告/作业等核心页面，沿用主题与鉴权逻辑。
- [ ] 题库/作业深度体验：题目详情 Markdown/代码高亮、标签过滤、作业倒计时与提交历史展示。
- [ ] 通知与消息中心：站内信/系统通知列表、已读状态、与邮件通知的联动设置。
- [ ] 权限与审计：操作日志覆盖关键管理动作，增加导出/筛选；补充异常态与重试。

## 后期（上线前）
- [ ] 性能与可用性：拆分路由懒加载、组件按需引入、骨架屏/占位符、移动端适配。
- [ ] 安全与配置：环境变量梳理、token 清理与过期处理、敏感操作二次确认。
- [ ] 可观测性：全局错误捕获、前端埋点与慢接口告警预留。
- [ ] 发布清单：回归测试手册、已知问题列表、Changelog/Release Note 编写。
