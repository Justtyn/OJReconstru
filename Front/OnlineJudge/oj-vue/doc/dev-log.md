# Re Online Judge 前端开发日志

> 规则：每次完成一轮架构设计或编码后，必须新增一条记录；同一天多次提交可以多条。日志用于跟踪进度、风险与待办，结构固定如下。

---

## 2025-12-24 20:36 客户端-个人主页统计对比优化

- **背景**：个人主页统计卡片背景与字体对比不足，区块宽度过大导致视觉松散。
- **动作**：
  1. 统计卡片改为更紧凑的宽度，网格列收窄并左对齐。
  2. 数值使用强调色，背景改为浅色渐变与更高对比描边，深浅色均可读。
- **产出/影响**：统计卡片更紧凑、数值更突出，视觉对比明显改善。
- **问题&风险**：无。
- **待办 / 下一步**：
  - [ ] 如需统一其他信息卡片配色，可继续调整。

## 2025-12-24 20:32 客户端-个人主页统计优化

- **背景**：个人主页/个人中心顶部统计信息层级不清晰，需要优化显示。
- **动作**：
  1. 提交通过率改为“百分比 + 明细”并列展示，明细使用胶囊样式。
  2. 得分与账号天数增加单位与说明，强化视觉层级与可读性。
- **产出/影响**：个人主页统计区更清晰、信息层级更明快。
- **问题&风险**：无。
- **待办 / 下一步**：
  - [ ] 如需更统一的统计样式，可同步更新学生主页详情卡片。

## 2025-12-24 20:28 客户端-顶部统计样式统一

- **背景**：需要删除部分页面的冗余标题描述，并统一顶部统计样式与排行榜一致。
- **动作**：
  1. 题库/题解/讨论/提交记录页移除营销式标题文案，仅保留筛选提示。
  2. 顶部统计改为胶囊样式并高亮数字，深浅色下对比一致。
- **产出/影响**：顶部区域更克制，统计信息更清晰。
- **问题&风险**：无。
- **待办 / 下一步**：
  - [ ] 如需进一步统一副标题文案，可继续调整。

## 2025-12-24 20:18 客户端-筛选区样式统一

- **背景**：需要将近期新增页面的顶部筛选区统一为紧凑样式，避免占用过多高度。
- **动作**：
  1. 题库/题解/讨论/提交记录/作业/排行榜等页面筛选区输入与按钮改为小尺寸，并收窄间距与输入宽度。
  2. 筛选区对齐为同一视觉节奏，保持深浅色主题下层次一致。
- **产出/影响**：筛选区更紧凑，页面首屏高度占用减少，整体更统一。
- **问题&风险**：无。
- **待办 / 下一步**：
  - [ ] 如需统一管理端筛选区样式，可另行调整。

## 2025-12-24 20:05 客户端-排行榜文案与样式优化

- **背景**：需要简化排行榜顶部文案与搜索区域，并增强统计信息可读性。
- **动作**：
  1. 顶部文案调整为“根据学生得分排序”，移除多余说明。
  2. 统计胶囊改为对比更强的底色，并突出数量字体颜色；搜索区域收窄宽度与按钮样式对齐。
- **产出/影响**：排行榜顶部更简洁，统计信息更醒目。
- **问题&风险**：无。
- **待办 / 下一步**：
  - [ ] 如需统一全站筛选样式，可抽象为公共过滤条组件。

## 2025-12-24 20:02 客户端-排行榜样式与字段补充

- **背景**：需要优化排行榜顶部信息区的体量与位置，并展示更多学生数据字段。
- **动作**：
  1. 增加 AC、提交数、通过率、性别、个人简介（截断）列，保持表格横向可读性。
  2. 收窄顶部区域，统计信息改为轻量胶囊样式，搜索区域更紧凑。
- **产出/影响**：排行榜信息密度更高且不影响页面高度，展示更清晰。
- **问题&风险**：排行榜仍为分页内排序；如需全量排序需后端支持。
- **待办 / 下一步**：
  - [ ] 如需全量排序，确认后端是否支持 score 排序参数。

## 2025-12-24 19:56 客户端-排行榜与作业

- **背景**：需要完善学生端排行榜与作业闭环，并实现班级加入后显示作业与作业题目联动。
- **动作**：
  1. 新增排行榜与学生主页页面，排行榜按学生得分排序，点击条目进入个人主页。
  2. 新增作业列表与作业详情页：未加入班级时展示班级列表与邀请码加入；加入后展示作业并按时间状态限制进入。
  3. 作业题目页跳转题目详情时携带 homeworkId，提交代码自动带上作业ID进行判题。
- **产出/影响**：客户端新增排行榜与班级作业流程，学生可加入班级后完成作业并提交带作业ID的判题。
- **问题&风险**：排行榜当前为前端分页内排序，若需全量排序需后端支持排序参数。
- **待办 / 下一步**：
  - [ ] 评估是否在提交记录中标记作业来源与快速回链。

## 2025-12-24 19:39 客户端-题解与讨论

- **背景**：需要为客户端补齐题解列表/详情与讨论列表/详情页面，满足浏览与阅读需求，并适配主题。
- **动作**：
  1. 新增题解列表与详情页，接入 `/api/solutions` 与 `/api/solutions/{id}`，展示作者、题目、语言与 Markdown 内容。
  2. 新增讨论列表与详情页，接入 `/api/discussions`、`/api/discussions/{id}` 与评论接口，展示讨论内容与评论列表。
  3. 更新客户端导航与路由，新增“题解”“讨论”入口，保证深浅色模式一致。
- **产出/影响**：客户端具备题解与讨论浏览能力，内容展示更完整。
- **问题&风险**：评论目前仅展示不支持提交；若后续开放互动需要加权限与防刷。
- **待办 / 下一步**：
  - [ ] 评估是否开放客户端侧发布题解/讨论与评论入口。

## 2025-12-24 19:27 客户端-提交状态与详情

- **背景**：需要为学生端补齐提交状态展示页与状态详情页，详细展示判题结果与用例情况。
- **动作**：
  1. 新增提交记录页 `SubmissionList`，按学生身份拉取 `/api/submissions`，展示状态、通过/总数、得分与时间，并支持题目/语言筛选。
  2. 新增提交详情页 `SubmissionDetail`，完整展示提交信息、源代码与测试点结果，并提供状态徽标与通过率概览。
  3. 更新客户端路由与导航入口，确保页面可达且适配深浅色主题。
- **产出/影响**：学生可从提交记录进入详情，查看每个用例的通过情况与输出信息。
- **问题&风险**：状态 ID 与状态文案依赖后端定义，若映射变更需同步调整徽标逻辑。
- **待办 / 下一步**：
  - [ ] 如需完整流程，可补充提交记录与题目详情的互链入口与刷新策略。

## 2025-12-24 19:05 客户端-题库与提交页

- **背景**：需要完善客户端题库浏览、题目详情与学生提交代码流程，确保深浅色模式下体验统一。
- **动作**：
  1. 新增题库列表页、题目详情页与提交代码页，接入 `/api/problems` 与 `/api/problems/{id}` 获取基础信息。
  2. 提交页复用管理端提交逻辑（语言列表+代码编辑器），但固定为当前学生身份提交 `/api/submissions`。
  3. 更新客户端路由与导航，开放“题库”入口并保证页面样式适配主题变量。
- **产出/影响**：客户端已具备题库浏览与题目提交闭环，学生可从列表进入详情再提交代码。
- **问题&风险**：语言列表为前端固定枚举，若后端变更需同步更新；提交后未展示判题详情，后续可扩展提交记录页。
- **待办 / 下一步**：
  - [ ] 若需要，新增客户端提交记录与判题详情展示。

## 2025-12-24 17:59 客户端-个人中心页面

- **背景**：需要为客户端补齐个人中心页面，统一展示学生信息、背景预留与设置入口，并接入修改信息/改密接口。
- **动作**：
  1. 完成个人中心布局：顶部背景+头像信息区，下方 Tab 分区（信息/背景/设置），所有区域使用主题变量适配深浅色。
  2. 信息 Tab 展示头像、账号、性别、邮箱、通过率、学校、得分、最后登录/语言、账号天数、个人简介，并加入学习概览卡片。
  3. 设置 Tab 增加“修改个人信息/修改密码”弹窗，更新学生信息调用 `/api/students/{id}`，修改密码调用 `/api/auth/password/change`。
- **产出/影响**：客户端个人中心可用，信息展示与基础设置操作闭环完成，视觉层级更清晰。
- **问题&风险**：头像/背景上传仍为 URL 直填占位，后续如需上传需接入文件接口与权限校验。
- **待办 / 下一步**：
  - [ ] 接入背景图真实资源与选择逻辑（如需）。

## 2025-12-15 16:30 客户端-关于页面

- **背景**：需要在客户端侧补齐“关于系统”页，用统一的卡片风格承载评测状态说明、使用指南与联系信息。
- **动作**：
  1. 新增客户端关于页 `src/apps/client/views/AboutView.vue`，用折叠面板组织 FAQ 内容，并在“评测返回信息”中使用 Table+Tag 提升可读性。
  2. 在客户端路由加入 `/about`，并在 `ClientLayout` 顶部导航新增“关于”入口。
  3. 使用 `--body-bg`、`--card-bg`、`--text-color` 等主题变量，确保深浅色模式下的对比度与层级一致。
- **产出/影响**：客户端已具备可访问的关于页入口，用户可自助查看状态含义、使用方式、功能说明、联系方式与学习资源。
- **问题&风险**：Blog 信息为占位文本（Justyn），如需可改为实际站点链接；后续页面内容应随功能开放情况更新。
- **待办 / 下一步**：
  - [ ] 若确认对外开放，可将“关于页”调整为 `allowGuest` 以便未登录也可访问。

## 2025-11-20 14:07 业务模块梳理

- **背景**：完成第 1 步「理解与抽象」，厘清后端接口覆盖范围并确认需要澄清的问题。
- **动作**：
  1. 阅读《Re Online Judge API》和《Re-OnlineJudge后端接口文档(25-11-20).md》。
  2. 通读《前端功能开发参考.md》了解目标页面结构。
  3. 梳理认证、题库、作业、讨论等模块及对应接口、主要字段。
  4. 输出客户端/管理端的模块职责矩阵并列出需确认问题。
- **产出/影响**：提交模块结构草图与接口列表，明确当前缺失的排行榜/统计/AI 接口及 Markdown 渲染需求。
- **问题&风险**：尚需在后续阶段关注 Markdown 渲染实现方式；扩展模块接口待后端补充。
- **待办 / 下一步**：
  - [ ] 根据确认结果输出整体前端架构设计（目录、路由、守卫、主题方案）。

## 2025-11-20 14:08 贡献指南编写

- **背景**：根据指示新增 AGENTS.md 作为仓库贡献指南，便于其他协作者遵循统一流程。
- **动作**：
  1. 调研 `package.json` 与目录结构，确定现有脚本、依赖与模块分布。
  2. 编写 200-400 字的《Repository Guidelines》，涵盖结构、命令、风格、测试、提交流程与安全提示。
  3. 将指南保存到根目录 `AGENTS.md` 并记录本次工作。
- **产出/影响**：新增标准化贡献文档，明确未来协作者的开发、提交和安全要求。
- **问题&风险**：暂无；未来根据测试栈或 lint 工具加入后需同步更新此文档。
- **待办 / 下一步**：
  - [ ] 继续进行第 2 步整体前端架构设计输出。

## 2025-11-20 14:08 前端架构方案设计

- **背景**：进入第 2 步要求，规划 client/admin 双端、路由、权限与主题切换方案，为后续初始化提供蓝图。
- **动作**：
  1. 明确单仓双入口（共享 Vite 工程 + 多 Layout）策略，列出目录划分示例。
  2. 设计客户端与后台路由草图，标注访问权限、角色要求与重定向策略。
  3. 描述 Pinia store 结构、axios 封装、router 守卫、主题切换（Ant Design ConfigProvider）方案。
  4. 输出计划供确认，暂不落地代码。
- **产出/影响**：形成正式前端架构方案，确定基础目录、守卫流程与主题实现路径。
- **问题&风险**：无；待确认后可进入项目初始化。
- **待办 / 下一步**：
  - [ ] 根据确认意见开展 Vite 项目初始化与基础设施搭建。

## 2025-11-20 16:28 架构方案确认

- **背景**：方案获批，进入第 3 步准备搭建 Vite+Vue3+TS 工程并实现基础设施。
- **动作**：
  1. 与用户确认目录、路由、守卫、主题、store 设计。
  2. 在日志中记录确认节点，为接下来的初始化与编码建立里程碑。
- **产出/影响**：正式进入项目初始化阶段，后续工作将按照既定方案推进。
- **问题&风险**：无。
- **待办 / 下一步**：
  - [ ] 初始化项目、安装依赖并搭建基础设施（第 3 步）。

## 2025-11-20 16:47 基础设施搭建

- **背景**：执行第 3 步，完成项目初始化、依赖声明、全局骨架、路由/状态/主题/请求封装及基础页面。
- **动作**：
  1. 补充 `axios`、`ant-design-vue`、`@ant-design/icons-vue` 依赖（npm 安装因受限网络多次超时，已在 `package.json` 声明，需本地重新执行 `npm install`）。
  2. 搭建目录结构（apps、layouts、router、stores、services、types、styles、utils），新增 Alias/tsconfig 配置。
  3. 实现 Pinia `auth`、`settings` store，配置 Router 守卫、白名单、client/admin 路由与布局。
  4. 编写 axios 拦截器、Auth Service、登录页、客户端首页、后台仪表盘、错误页与基础主题。
- **产出/影响**：形成可运行的前端基础框架，满足登录 -> 守卫 -> 客户端/后台跳转流程，为后续模块开发提供模板。
- **问题&风险**：依赖未能在当前环境安装，需在联网环境运行 `npm install`；尚未实现注册/忘记密码等页面。
- **待办 / 下一步**：
  - [ ] 按模块逐步实现客户端业务页面与服务调用（第 4 步）。

## 2025-11-20 16:58 客户端模块-公告

- **背景**：启动第 4 步客户端模块实现，优先落地“公告”以验证服务封装、Markdown 渲染与列表/详情交互。
- **动作**：
  1. 新增公告类型/服务（`src/types/dto/announcement.ts`、`src/services/modules/announcement.ts`），补充 `marked`、`dompurify`、`date-fns` 依赖与 `markdown` 工具。
  2. 在客户端路由与布局中加入 `/announcements` 入口。
  3. 开发 `AnnouncementList.vue`，提供搜索、置顶过滤、分页、详情抽屉及 Markdown 预览。
- **产出/影响**：客户端可浏览公告列表并查看详情，具备 Markdown 渲染与安全净化流程。
- **问题&风险**：受网络限制新增依赖仍需本地 `npm install`；后续需扩展更多筛选项及缓存策略。
- **待办 / 下一步**：
  - [ ] 实现下一个客户端业务模块（例如题库或班级/作业）。

## 2025-11-20 17:09 身份体系加强计划

- **背景**：根据新要求，需在开发业务模块前完善登录/注册/邮箱验证/找回密码及多角色跳转体验，确保 Token 与用户信息完整存储。
- **动作**：
  1. 评估 Auth 模块需覆盖的接口：`/api/auth/register`、`/verifyEmail`、`/login`、`/logout`、`/password/forgot/*`、`/password/change`。
  2. 规划 `AuthLayout`、验证码组件、注册/忘记密码页面及主题一致性方案。
  3. 明确学生进入客户端、教师/管理员进入管理端的守卫逻辑。
- **产出/影响**：确定“先强化身份模块再扩展业务”路线，为接下来的页面开发提供方向。
- **问题&风险**：无（需留意暗色/浅色主题在 Auth 页的适配）。
- **待办 / 下一步**：
  - [ ] 设计并实现 Auth 页面及相关 service/store 改造。

## 2025-11-20 17:15 身份模块实现

- **背景**：落地登录/注册/邮箱验证/找回密码流程，确保三角色分流与主题统一，满足“先完善身份模块再开发业务”的要求。
- **动作**：
  1. 新增 Auth 服务与类型（注册、验证、忘记密码、改密）以及 Pinia 扩展（session 恢复、pendingVerifyUser、验证码发送等）。
  2. 构建 `AuthLayout`、`ThemeSwitcher`、`Logo`，更新 Client/Admin Layout 主题切换；编写登录/注册/验证/找回密码页面，集成角色分流与现代 UI。
  3. 加强 Router 守卫（按角色区分 client/admin 入口），完善主题 Store（监听系统主题、设置 `data-theme`），补充 Markdown/DOMPurify 依赖提示。
- **产出/影响**：完整的身份体系已就绪：注册→发信→验证→登录→按角色跳转；忘记密码具备两步校验；界面支持深浅主题切换，整体设计统一。
- **问题&风险**：新增依赖（marked、dompurify、date-fns 等）仍需在有网络环境执行 `npm install`；`package-lock.json` 未更新，待安装后同步。
- **待办 / 下一步**：
  - [ ] 基于完善的身份体系继续推进客户端业务模块（题库/班级/作业等）。

## 2025-11-20 17:19 Bug 修复（主题图标）

- **背景**：本地运行时报 `MoonOutlined` 未导出导致路由初始化失败，登录页无法渲染，需要快速修复 ThemeSwitcher。
- **动作**：
  1. 将 ThemeSwitcher 中的深色模式图标改为 `BgColorsOutlined`，确保所用 icon 均存在于 `@ant-design/icons-vue`。
  2. 抽查登录页渲染确认不再抛出模块解析错误。
- **产出/影响**：修复后应用可正常加载登录页，黑屏问题消除。
- **问题&风险**：无。
- **待办 / 下一步**：
  - [ ] 继续推进客户端业务模块开发。

## 2025-11-20 18:21 Auth 体验优化

- **背景**：根据反馈调整登录/注册等页面的居中样式，并限制注册仅创建学生账号，同时确保表单操作直连真实 API。
- **动作**：
  1. 在全局样式增加 `.auth-form`，并为登录/注册/验证/找回密码表单应用该类，实现输入区域水平居中。
  2. 注册页移除角色选择，固定仅创建 `student`，并加入说明提示；其余流程继续复用 `authService`。
  3. 验证相关组件的 UI 小幅调整（Info Alert 等），确保体验一致。
- **产出/影响**：登录/注册页视觉居中；注册逻辑与后端约束一致，避免教师/管理员直接前台注册。
- **问题&风险**：无。
- **待办 / 下一步**：
  - [ ] 开始实现管理端（管理员/教师）模块。

## 2025-11-20 18:28 Auth 表单触发兼容

- **背景**：用户端反馈某些浏览器/插件拦截 form submit 导致登录/注册无响应，需要保证按钮点击即可触发请求。
- **动作**：
  1. 为登录/注册/验证/找回密码表单新增 `@keyup.enter` 监听，并让按钮改用 `@click="handleXXX"`（不再依赖原生 submit）。
  2. 保留 `@submit.prevent` 以拦截默认行为，确保即便插件影响原生 submit，点击按钮仍可发起 API 请求。
- **产出/影响**：Auth 表单在各种环境下都能触发校验与网络请求，解决“点击无效”的问题。
- **问题&风险**：暂无。
- **待办 / 下一步**：
  - [ ] 继续实现管理端模块。

## 2025-11-20 18:34 开发环境 API 配置

- **背景**：前端默认 baseURL 为空导致请求落在 Vite 本地地址，需要明确指向后端 `localhost:8080`。
- **动作**：
  1. 新增 `.env.development`，设置 `VITE_API_BASE_URL=http://localhost:8080`。
  2. 确认 axios 实例读取该变量，重启 dev server 后所有 API 将直连后端接口。
- **产出/影响**：开发环境下登录/注册等请求会发送到后端服务，无需手动修改代码。
- **问题&风险**：若后端端口或域名不同，需要对应调整 `.env.*`；请勿提交生产环境敏感地址。
- **待办 / 下一步**：
  - [ ] 实现管理端业务页面。

## 2025-11-20 18:43 管理端管理员/教师模块

- **背景**：根据步骤要求实现后台管理员与教师管理功能（列表、表单、启用/禁用、删除等），并补齐类型/服务/路由。
- **动作**：
  1. 新增用户相关类型、分页定义、服务封装（`adminUserService`、`teacherService`），并为 axios 引入 `dayjs` 依赖用于日期格式化。
  2. 扩展路由与 AdminLayout 菜单，新增 `/admin/users/*`、`/admin/teachers/*`，按角色控制可见范围。
  3. 实现 `AdminList/AdminEdit`、`TeacherList/TeacherEdit` 页面：包含筛选表单、表格分页、启禁与删除操作、表单验证（邮箱/手机号/密码），并与真实 API 对接。
- **产出/影响**：管理端已具备管理员与教师的增删改查 UI，角色访问及权限按钮控制齐备，可以在成功登录后直接操作后端数据。
- **问题&风险**：`dayjs` 等新依赖需 `npm install`；启禁操作基于 `isActive` 字段，若后端命名不同需同步调整。
- **待办 / 下一步**：
  - [ ] 按计划继续扩展其他管理模块（班级、公告等）。

## 2025-11-20 18:52 管理端表格编译错误修复

- **背景**：由于在 `<script setup>` 中使用 JSX 自定义列导致 Vite 动态导入失败（500 错误），需改用 AntD Table 的 slot 写法。
- **动作**：
  1. `AdminList.vue` 与 `TeacherList.vue` 改为定义 `columns` 并通过 `<template #bodyCell>` 渲染状态/操作列，不再依赖 JSX。
  2. 引入 `TableColumnType` 类型，确保 TS 推断正确；重新格式化操作区逻辑。
- **产出/影响**：路由懒加载可以正常解析，管理端列表页成功编译渲染。
- **问题&风险**：无。
- **待办 / 下一步**：
  - [ ] 继续扩展其他后台模块。

## 2025-11-20 18:59 Admin/Teacher 列表加载 & ID 精度修复

- **背景**：Vite 仍然因 `dayjs`（未安装）报 500，教师详情请求也因大整数 ID 被 `Number()` 截断导致 404。
- **动作**：
  1. 列表页改用 `date-fns`（已有依赖）格式化时间并移除 `dayjs` 引用；同步删除 `package.json` 中的 `dayjs` 依赖。
  2. 将 `AdminUser`、`Teacher` 的 `id` 类型改为 `string`，服务/页面调用不再做 `Number()` 转换，直接使用路由参数字符串请求后端。
- **产出/影响**：管理端列表组件可正常按需加载，教师编辑不再 404。
- **问题&风险**：如后端 ID 后续改为数字，请同步更新类型。
- **待办 / 下一步**：
  - [ ] 继续构建其他管理模块。

## YYYY-MM-DD HH:mm 模块/阶段标题

- **背景**：当前处理的任务或阶段目标说明。
- **动作**：
  1. ...
  2. ...
- **产出/影响**：本次产出的文件、模块、接口或其他显著结果。
- **问题&风险**：发现的阻碍、需确认事项（若无写“无”）。
- **待办 / 下一步**：
  - [ ] TODO 1
  - [ ] TODO 2

> 注：将 `YYYY-MM-DD HH:mm` 替换为实际时间，动作列表采用动词开头描述具体行为；待办勾选完成后改为 `[x]`。

## 2025-11-20 22:10 深色适配与公告筛选修复

- **背景**：深色模式下布局仍有白底，公告后台置顶筛选未生效，角色入口需区分客户端/管理端。
- **动作**：
  1. 全局和 `PageContainer` 使用主题变量控制背景/文字颜色，适配 Ant Layout/Card，解决深色模式白底。
  2. 客户端顶部菜单仅学生显示个人中心，管理员/教师看到管理系统入口；路由只阻止学生访问后台。
  3. 公告管理置顶筛选参数同时传 `pinnedOnly/isPinned` 并在切换时立即触发查询。
  4. 修复 Axios 包装和 TS 类型问题，确保构建通过。
- **产出/影响**：深色模式视觉一致；角色导航符合预期；公告置顶筛选可生效；`npm run build` 通过。
- **问题&风险**：公告筛选依赖后端对 `pinnedOnly/isPinned` 支持，如仍无效需确认后端实现。
- **待办 / 下一步**：
  - [ ] 若后端改动筛选参数，前端同步调整。

## 2025-11-21 08:02 学生管理 & 登录日志实现

- **背景**：按计划补齐后台学生管理与日志管理，需对齐接口字段、深浅色主题和分页体验。
- **动作**：
  1. 学生列表改用用户名/邮箱查询参数，保持分页、验证状态 Tag 展示，避免使用后端未支持的 keyword。
  2. 新增登录日志类型与服务（列表/详情/删除），路由与侧栏菜单加入“登录日志”入口（仅管理员可见）。
  3. 开发登录日志列表页：角色/UserID 过滤、成功/失败 Badge、登录/登出时间格式化、查看 Drawer 展示 IP/UA/设备/失败原因，支持删除记录。
- **产出/影响**：后台可直接检索并维护学生数据，管理员可查看/删除登录日志，界面延续卡片与深浅色主题。
- **问题&风险**：日志接口未提供时间范围过滤，后续可追加；删除日志可能需审批，请确认运营策略；UserID 当作字符串传递以避免大整数截断。
- **待办 / 下一步**：
  - [ ] 若需要时间范围/成功状态筛选，与后端确认参数后追加。
  - [ ] 补充日志导出或批量删除能力（如有需求）。

## 2025-11-21 08:12 题目管理与用例管理落地

- **背景**：按计划接入后台题目表与题目用例表，支持题目 CRUD、用例查看/编辑/删除，页面需沿用统一主题与分页交互。
- **动作**：
  1. 新增题目/用例类型、服务与管理员路由、侧栏菜单入口（题目管理），合并到 admin。
  2. 开发题目列表页：关键词/难度/标签/状态筛选，难度 Tag、状态 Badge、分页与删除确认。
  3. 开发题目编辑页：基础信息表单（标题/难度/限时/内存/标签/描述/输入/输出/提示/状态），并内嵌用例表格与用例抽屉表单，支持新增/编辑/删除用例、样例标记/启用开关、输入输出多行编辑。
- **产出/影响**：后台可新建/编辑题目并管理其测试用例；角色入口对齐教师/管理员；统一深浅色卡片、抽屉与分页。
- **问题&风险**：后端用例接口路径假设 `/api/problems/{id}/cases` 与 `/api/problem-cases/{caseId}`，若不一致需调整；缺少时间范围筛选/用例批量导入，如有需求再补。
- **待办 / 下一步**：
  - [ ] 确认后端用例接口与字段（score/isSample/isActive）是否一致，若不同调整服务层。
  - [ ] 补充题目内容的富文本/Markdown 编辑与预览（如有需求）。
  - [ ] 若用例详情路径/字段更新，需要同步服务层（已对齐 `/api/admin/problem-testcases/{id}`）。
  - [ ] 已将题目创建/更新/查询改为 `/api/admin/problems/*`，如再有权限或路径变更需同步。

## 2025-12-11 10:43 教师/学生列表补充性别与通过率

- **背景**：管理端教师与学生列表需与管理员列表一致展示性别，同时学生列表需要体现 AC/提交与通过率。
- **动作**：
  1. 教师列表新增「性别」列，使用 Tag 显示男/女/未填写并区分颜色。
  2. 学生列表新增「性别」列，以及 AC、提交列；通过 AC/提交计算通过率（无提交时为 0%），以 Tag 展示。
- **产出/影响**：三类列表的性别展示统一；学生的刷题表现（AC、提交、通过率）一目了然，便于管理。
- **问题&风险**：若后端性别或成绩枚举变化需同步映射；通过率保留一位小数。
- **待办 / 下一步**：
  - [ ] 若后端提供性别枚举或需要更多统计字段，继续对齐。

## 2025-12-11 10:54 教师职称枚举与表单顺序优化

- **背景**：要求教师职称采用固定枚举并可自定义输入，同时调整表单顺序将姓名紧随用户名，其后是密码与重复密码。
- **动作**：
  1. 教师编辑页引入职称候选列表（助教/讲师/副教授/教授/特聘教授/外聘/兼职/高级工程师/研究员/首席专家），使用 AutoComplete 支持枚举选择与自定义输入。
  2. 调整表单布局：用户名-姓名同排，下一排为密码与确认密码，后续为职称/性别、邮箱/手机号。
- **产出/影响**：职称选择统一且保留扩展性；表单顺序更符合填写习惯，减少跳转。
- **问题&风险**：如后端提供职称枚举接口需同步源数据；AutoComplete 自定义值需后端兼容。
- **待办 / 下一步**：
  - [ ] 若后端下发职称字典，改为动态加载。

## 2025-12-11 10:58 管理员/学生编辑表单排版修复

- **背景**：管理员与学生编辑页存在单个输入项独占整行的问题，影响填表效率，需要压缩排版。
- **动作**：
  1. 管理员编辑页调整为：用户名+姓名、密码+确认密码、性别+出生日期、邮箱+手机号四行两列，消除单列行。
  2. 学生编辑页调整为：用户名+姓名、密码+确认密码、性别+出生日期、学校+邮箱、手机号+积分、个人简介独占最后一行，避免孤立字段。
- **产出/影响**：表单布局更紧凑，输入顺序符合习惯，提升管理端录入体验。
- **问题&风险**：无。
- **待办 / 下一步**：
  - [ ] 若需要再分组或自适应更细的断点，可按屏幕尺寸细调 `col` 配置。

## 2025-12-11 11:16 登录页本地验证码

- **背景**：登录需增加本地 6 位字母数字混合验证码，先行校验后再请求后端，并兼容深浅主题。
- **动作**：
  1. 登录页新增验证码输入与本地生成器（6 位去除易混字符），支持点击/按钮刷新，初始挂载即生成。
  2. 验证码先行校验（必填、小写对比），失败自动刷新并聚焦输入框，校验通过后再调用登录接口。
  3. 验证码展示容器使用主题变量背景/文字/边框并加阴影，移动端垂直排列，适配深浅模式。
- **产出/影响**：登录前必须通过本地验证码，降低撞库风险；界面在深浅色下均可读并支持移动端。
- **问题&风险**：验证码为本地生成未与后端联动，如需后端校验需追加接口支持。
- **待办 / 下一步**：
  - [ ] 若后续要求服务端验证码或频控，扩展为后端下发。

## 2025-12-11 11:21 登录验证码交互修正

- **背景**：登录页验证码需紧贴密码下方，取消「换一张」按钮并消除重复提示。
- **动作**：
  1. 将验证码表单项移动到密码下方，点击验证码区域即可刷新，移除多余按钮。
  2. 精简校验规则为单一自定义校验，消除重复“请输入验证码”提示；调整焦点顺序为 用户名→密码→验证码→角色→提交。
- **产出/影响**：验证码交互简洁、顺序合理，不再出现重复校验文案。
- **问题&风险**：仍为本地验证码，如需防止刷号需结合后端验证码/频控。

## 2025-12-11 11:42 作业题目选择与二级列表

- **背景**：作业需支持检索多选题目，并在列表二级展开展示当前作业题目，效果与题目管理一致且仅可移除。
- **动作**：
  1. 作业编辑页将题目输入改为远程检索多选下拉，加载题目选项并在编辑时预加载已选题目；提交时按选中题目 ID 列表写入。
  2. 为作业列表新增展开行，展示该作业包含的题目表（难度/状态/AC/提交/更新时间），支持从作业中移除题目但不编辑题目内容。
  3. homework 服务新增题目批量/查询/移除接口封装，类型补充 HomeworkProblem/批量请求；适配接口返回直接为数组的题目数据。
- **产出/影响**：创建/编辑作业可直接从题库检索多选题目；列表可快速查看并移除作业题目，界面风格与题目管理保持一致。
- **问题&风险**：题目列表接口假设支持关键词分页检索；若后端返回字段与 Problem 不同需同步映射。

## 2025-12-11 11:50 作业编辑题目预加载修复

- **背景**：作业编辑页需直接展示当前已包含的题目列表（接口返回数组），之前仅依赖 problemIds 预加载不足。
- **动作**：
  1. 编辑态调用 `/api/homeworks/{id}/problems` 直接加载题目数组，设置已选 ID，并将结果合并到下拉选项。
  2. 移除逐个详情预加载逻辑，避免字段缺失导致无法展示。
- **产出/影响**：进入编辑页即可看到当前已选题目并保留在多选下拉中，便于增删题目。
- **问题&风险**：如后端返回字段变化需同步选项映射。

## 2025-12-11 11:52 作业编辑可追加题目

- **背景**：已包含题目时，编辑页面无法再搜索/添加其他题目，需要允许继续检索。
- **动作**：
  1. 打开下拉即触发空关键字检索，并将新结果与已选项合并去重。
  2. 优化选项合并逻辑，确保已选题目始终保留标签，搜索结果可追加新的可选题目。
- **产出/影响**：编辑作业时即便已有题目，也能继续检索并添加其他题目。
- **问题&风险**：如题目量大需进一步做防抖或分页。

## 2025-12-11 12:00 作业题目保存流程对齐接口

- **背景**：作业的题目需通过单独接口 `/api/homeworks/{id}/problems` 同步，不能直接随作业创建/更新提交。
- **动作**：
  1. 作业创建/更新只提交作业基本信息，新增 `syncHomeworkProblems` 根据已选/原始题目差异调用移除与批量添加接口。
  2. 编辑态加载已有题目后记录原始 ID 集合，用于差异化同步；新增/删除题目时分别调用 add/remove 接口。
- **产出/影响**：作业保存流程符合后端接口规范，题目增删同步到作业题目表。
- **问题&风险**：大批量增删可能需要后端批处理优化；若后端返回字段变更需同步处理。

## 2025-12-11 12:06 作业题目 ID 精度修复

- **背景**：作业题目 ID 较大，转换为 Number 时精度丢失导致后端校验“题目列表包含不存在的记录”。
- **动作**：
  1. 题目同步使用字符串/原始 ID 直接提交，不再转为 Number；批量请求类型支持 string|number。
  2. 保持移除接口参数为原始 ID，避免精度问题。
- **产出/影响**：大整数题目 ID 可正常同步到作业题目表，避免不存在记录错误。
- **问题&风险**：如后端严格要求数字类型需确认是否接受字符串数字并据此调整。

## 2025-12-11 12:30 班级创建者/学生管理与列宽优化

- **背景**：班级列表需展示创建者名称、加宽名称列，并支持二级展开查看/移除班级学生；班级编辑需增删学生，走独立班级成员接口。
- **动作**：
  1. 班级类型补充 `creatorName`，列表加宽名称列并新增“创建者”列；展开行展示班级学生表，可移除学生。
  2. 新增班级成员服务/类型，二级表从班级成员接口获取学生 ID 并抓取学生详情显示用户名/姓名/邮箱等。
  3. 班级编辑页新增学生多选检索（支持用户名/邮箱搜索），加载已有学生记录原始 memberId，保存时差异化调用 `classes-members` 新增/删除接口。
- **产出/影响**：班级列表可直接看到创建者并查看当前学生；创建/编辑班级可添加或移除学生，数据同步班级成员表。
- **问题&风险**：班级成员批量操作为多次调用，若数据量大需后端批处理优化；学生接口若不支持按邮箱模糊需调整搜索参数。

## 2025-12-11 12:40 班级创建者显示用户名

- **背景**：班级列表创建者需显示教师用户名而非 ID。
- **动作**：
  1. 班级列表加载后批量获取创建者教师详情并缓存，渲染时优先显示用户名。
  2. 保留 creatorName/creatorId 兜底，避免单条获取失败导致空白。
- **产出/影响**：班级列表创建者列展示教师用户名，体验一致。
- **问题&风险**：若创建者非教师需确认接口返回的姓名来源。

## 2025-12-11 13:00 题解管理模块

- **背景**：新增题解管理功能，题解发布者为学生，题目单选，语言前端枚举，需要兼容雪花 ID。
- **动作**：
  1. 新增 Solution 类型/服务与路由、侧栏菜单；列表页支持关键词、题目、作者、状态筛选，显示语言、创建时间，支持删除与编辑入口。
  2. 新建/编辑页：题目单选远程检索、发布学生单选远程检索、语言枚举（C/C++/Java/Python/Go/JS/TS/Rust/Kotlin/PHP/C#）、内容与状态编辑；保存时创建走题目路径接口，编辑走 `/api/solutions/{id}`，保留字符串 ID 避免精度问题。
  3. 题目/学生选项检索与详情预加载，确保已选项可显示标签。
- **产出/影响**：管理端可维护题解并指定发布学生与题目，支持增删改查。
- **问题&风险**：若后端接口要求 userId/语言枚举精确值需确认；题目/学生搜索接口性能需关注。

## 2025-12-11 14:52 讨论管理与评论二级管理

- **背景**：需实现讨论管理，支持学生发布、关联题目，并对评论进行二级管理，注意雪花 ID 精度。
- **动作**：
  1. 新增 Discussion/Comment 类型与服务，路由/菜单加入“讨论管理”入口。
  2. 讨论列表支持关键词、题目、作者、状态筛选，展示题目/作者名称缓存；展开行展示评论列表并可删除评论。
  3. 新建/编辑页：题目单选、发布学生单选（远程检索），标题/内容/状态编辑；创建走 `/api/discussions`，编辑走 `/api/discussions/{id}`，全程使用字符串 ID。
- **产出/影响**：管理端可增删改查讨论并管理评论，满足题目/学生绑定与雪花 ID 精度要求。
- **问题&风险**：评论目前仅支持删除，如需编辑/新增需补充；搜索接口性能需关注。

## 2025-12-11 17:50 学生头像上传与讨论入口调整

- **背景**：后端限制仅学生能新建讨论；学生管理需支持头像上传/显示并配置前缀。
- **动作**：
  1. 讨论列表移除“新建讨论”按钮，保持仅编辑/删除入口。
  2. 学生列表新增圆角正方形头像列，不改变行高；默认用用户名首字母。
  3. 学生编辑/新建新增头像上传（校验图片、正方形），默认前缀 `http://localhost:8080` 可手动调整；上传返回后拼接前缀保存头像 URL，未上传时使用默认头像。
- **产出/影响**：遵循讨论权限要求；学生头像可上传/预览/保存并在列表展示。
- **问题&风险**：头像上传接口路径依赖后端 `/api/files/avatar`；前缀需与后端实际部署一致，如域名变更需同步修改。

## 2025-12-11 18:05 学生头像体验与权限修复

- **背景**：头像列导致编译错误、尺寸过大，前缀需要统一配置且上传需携带 Token。
- **动作**：
  1. 头像列改用表格插槽渲染，尺寸缩小为 40，使用前缀拼接且保留首字母占位；AC/提交/通过率/积分列缩窄，学校列加宽。
  2. 学生列表增加头像前缀输入+保存（localStorage），统一应用到列表显示；学生编辑页仅展示当前前缀，不可修改。
  3. 头像上传区域美化（图标替换、文本使用主题色），上传校验正方形/图片格式，默认前缀拼接，缺省使用默认头像；上传请求附加 Bearer Token 解决 401。
- **产出/影响**：编译错误修复，头像展示更协调；前缀统一管理，上传能携带身份，深浅色文本可读。
- **问题&风险**：前缀仍需与部署环境同步，上传接口路径需确认；如需批量更新已有头像需另行处理。

## 2025-12-11 18:20 头像上传 Token 纠正

- **背景**：上传头像接口报 401，Authorization 出现“Bearer Bearer ...”双前缀。
- **动作**：上传请求头改为先去掉已有 `Bearer ` 前缀，再拼接一次，避免重复前缀导致鉴权失败。
- **产出/影响**：上传接口可正确携带单一 Bearer Token，避免 401。
- **问题&风险**：如后端返回的 token 仍含其他前缀需再确认。

## 2025-12-11 18:28 头像上传返回兼容

- **背景**：上传接口返回 `{ data: { url: '/files/avatars/xxx.jpg' } }`，若直接调用 `startsWith` 会因非字符串报错。
- **动作**：解析上传返回时优先取 `data.url`，`resolveAvatar` 仅在字符串时调用前缀拼接，缺省回退默认头像。
- **产出/影响**：上传完成不再抛出 `startsWith is not a function`，头像正常预览和保存。
- **问题&风险**：如后端返回结构再变需同步解析逻辑。

## 2025-12-11 19:10 提交记录管理

- **背景**：需要后台查看提交列表与详情，支持题目/学生/语言/状态筛选，并展示测试点与源代码，处理雪花 ID。
- **动作**：
  1. 新增 Submission 类型/服务，路由与菜单加入“提交记录”，列表支持题目、学生、语言（按提供的映射）、状态筛选，展示 AC/总数、得分、时间。
  2. 详情页展示基础信息、语言标签、状态 Badge、代码块、测试点结果（stdout/stderr/编译输出/消息/时间/内存），题目与学生名称通过远程缓存。
  3. 题目/学生搜索沿用远程下拉，所有 ID 保持字符串以避免精度问题。
- **产出/影响**：管理端可方便查询提交记录并查看详细测试点与代码。
- **问题&风险**：代码高亮未加，如需可后续引入；状态/语言映射需与后端保持一致。

## 2025-12-11 10:38 管理员列表展示性别

- **背景**：根据返回数据中的 `sex` 字段，需要在管理员列表中直接展示性别信息，便于审核。
- **动作**：
  1. 管理员列表新增「性别」列，使用 Tag 显示男/女/未填写并区分颜色。
  2. 补充性别标签映射与颜色函数，保持缺省值展示“未填写”。
- **产出/影响**：列表可直接查看性别，无需进入编辑页，提升管理效率。
- **问题&风险**：若后端新增其他枚举值需同步映射；当前空值显示“未填写”。
- **待办 / 下一步**：
  - [ ] 如后端提供性别枚举列表，统一前端枚举来源。

## 2025-12-11 10:30 迭代路线规划

- **背景**：根据最新指示梳理管理端剩余细节与客户端启动计划，需形成可执行的迭代 TODO。
- **动作**：
  1. 新增 `TODO.md`，按近期/下阶段/中期/后期拆解任务，覆盖用户/班级/题库完善、统计图表、邮件模板、验证码重发与本地验证码、作业题目多选加载、学生信息扩展、教师职称枚举、班级创建者与学生下拉、多角色导航、客户端启动等需求。
  2. 将阶段性目标细化至上线前的性能、安全、可观测性与发布清单，保证后续开发有明确优先级。
- **产出/影响**：仓库新增迭代路线图，所有待优化点与后续模块均有明确分期与执行要点，便于团队跟踪。
- **问题&风险**：暂无；后续需结合后端接口确认统计与验证码方案实现细节。
- **待办 / 下一步**：
  - [ ] 启动近期阶段任务（管理端页面完善、作业题目多选、班级/学生增强、导航与验证码能力）。

## 2025-11-21 07:56 学生管理与登录日志计划

- **背景**：进入后台模块扩展阶段，下一轮需完成学生管理与登录日志管理，需先对齐接口字段与表单/筛选设计。
- **动作**：
  1. 阅读 `doc/API_DOC.md` 中 `student-controller`、`login-log-controller` 接口，确认列表分页参数（用户名/邮箱/角色/用户ID）及详情/增改字段（出生日期、学校、设备信息等）。
  2. 规划学生管理页面的表单与表格列：支持用户名/邮箱模糊搜索、性别/学校等基础字段编辑，保持启用/删除操作与管理员、教师模块一致。
  3. 设计登录日志列表：展示角色、用户、IP、UA、设备、登录/登出时间、成功状态；支持按角色、用户过滤并保留深浅色一致的表头卡片样式。
  4. 评估所需 UI 组件（RangePicker、Tag、Badge 等）与复用的主题 token，避免硬编码颜色，确保操作列与卡片阴影在暗色模式可读。
- **产出/影响**：明确学生与登录日志模块的字段、交互与主题要求，可直接进入编码实现。
- **问题&风险**：接口未提供时间范围过滤，日志分页可能较大需加加载状态与空/错误态；学生表单的日期格式需与后端 `yyyy-MM-dd` 保持一致。
- **待办 / 下一步**：
  - [ ] 开发学生管理列表/表单/启禁删除流程并接入服务层。
  - [ ] 开发登录日志列表与详情查看，补齐筛选与分页体验。
